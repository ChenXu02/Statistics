# Comparison of CRPS and Energy Score

## Similarities

1. **Probability-based Scoring**  
   Both CRPS (Continuous Ranked Probability Score) and Energy Score evaluate the match between a predicted distribution $F$ and the true value $x$.

2. **Formula Structure**  
   Both metrics consist of two components:
   - **Internal consistency of samples**: Measures relationships among samples within the predicted distribution.
   - **Match between samples and true value**: Measures distances between samples and the true value.

   Sampling-based forms:
   - $\text{CRPS}(F,x)= E_{Y \sim F}[\|Y-x\|]-\frac{1}{2}{E}_{Y,Y'\sim F}[\|Y-Y'\|]$
   - $\text{ES}(F, x) = E_{Y, Y' \sim F}[\|Y - Y'\|] - 2{E}_{Y \sim F}[\|Y - x\|]$

4. **Non-parametric**  
   Neither metric depends on an explicit parametric form of the predicted distribution; both can be computed through sampling.

5. **Evaluation of Predictive Distribution Quality**  
   Both metrics measure the reasonableness of the predictive distribution $F$, making them suitable for evaluating generative models (e.g., VAEs, GANs) or probabilistic predictions.

---

## Differences

| **Feature**                 | **CRPS**                                                            | **Energy Score**                                                    |
|-----------------------------|----------------------------------------------------------------------|----------------------------------------------------------------------|
| **Applicable Dimension**     | Univariate distributions ($d = 1$)                              | Multivariate distributions ($d > 1$)                           |
| **Distance Metric**          | Absolute error                                                  | Euclidean distance                                             |
| **Covariance Information**   | Does not capture relationships between variables                   | Implicitly captures relationships between variables via sample geometry |
| **Computational Complexity** | Simpler analytical form, closed-form solutions for some distributions (e.g., Gaussian) | Higher computational complexity, especially in high dimensions      |
| **Target Distribution Type** | Requires well-defined cumulative distribution function (CDF)        | Suitable for complex distributions (e.g., generated by GANs or VAEs) |
| **Information Captured**     | Focuses on univariate fit to the true value                        | Captures global characteristics of the distribution and sample structure |
| **Core Application Scenarios** | Weather forecasting, time-series prediction, and other univariate tasks | Image generation, traffic prediction, and other multivariate tasks |

---

## Summary
- **CRPS**: Best suited for univariate tasks, emphasizing fit to the true value. It is simple and computationally efficient.
- **Energy Score**: Designed for multivariate tasks, evaluating global distribution properties and capturing inter-variable relationships. Ideal for complex generative tasks.

Choose the appropriate metric based on the dimensionality and characteristics of your task.
